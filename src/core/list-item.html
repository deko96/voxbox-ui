<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-item/paper-item-body.html">
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="item-behavior.html">
<link rel="import" href="item-styles.html">

<dom-module id="list-item">
    <template>
        <style include="item-styles"></style>
        <div class$="[[_itemClass(selectMode, grid)]]">
            <paper-item role="menuitemcheckbox">
                <paper-checkbox
                    on-tap    = "_toggleSelected"
                    checked   = "[[selected]]">
                </paper-checkbox>
                <paper-item-body>
                    <div secondary class="date">
                        <span>[[_formatDate(item.timestamp)]]</span>
                    </div>
                    <div>[[item.endpoint]]</div>
                </paper-item-body>
                <template is="dom-if" if="[[!grid]]">
                    <template is="dom-if" if="[[favoritable]]">
                        <paper-icon-button
                            class   = "star"
                            on-tap  = "_toggleFavorite"
                            icon    = "[[_favoriteButtonIcon(item.favorite)]]">
                        </paper-icon-button>
                    </template>
                    <paper-icon-button 
                        on-tap  = "_showMessage"
                        icon    = "unfold-more">
                    </paper-icon-button>
                </template>
            </paper-item>
            <div class="content">
                [[_truncated(item.content)]]
            </div>
            <template is="dom-if" if="[[grid]]">
                <div class="controls">
                    <template is="dom-if" if="[[favoritable]]">
                        <paper-icon-button 
                            class  = "star"
                            on-tap = "_toggleFavorite"
                            icon   = "[[_favoriteButtonIcon(item.favorite)]]">
                        </paper-icon-button>
                    </template>
                    <paper-icon-button 
                        on-tap = "_showMessage"
                        icon   = "unfold-more">
                    </paper-icon-button>
                </div>
            </template>
        </div>
    </template>
    <script>
    var MAX_MESSAGE_LENGTH = 130;

    Polymer({

        is: 'list-item',

        properties: {
            favoritable: {
                type: Boolean,
                notify: true,
                value: false
            }
        },
        behaviors: [
            ItemBehavior
        ],

        ready: function() {
            // ..
        },

        _truncated: function(content) {
            if (!this.grid) return content;
            return (content.length > MAX_MESSAGE_LENGTH) 
            ? content.substring(0, MAX_MESSAGE_LENGTH) + 'â€¦' : content;
        },

    });

    </script>
</dom-module>
